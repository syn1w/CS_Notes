# 一、量化设计和分析基础

## 1. 介绍

指令集

- CISC(**C**omplex **I**nstruction **S**et **C**omputing)，Intel 在内部也将 x86 指令转换为类似于 RISC 指令。
- RISC(**R**educed **I**nstruction **S**et **C**omputing)，主要关注在指令集并行（流水线到多指令）和缓存的使用（后来采用复杂的组织方式和优化）上。ARM 架构。

![Growth](../../imgs/arch/1_1.png)

可以看到摩尔定律正在失效。现在增加核心数来提高性能。甚至大型机也是由微处理器组成。

处理器的性能的提高从单纯依赖指令集并行(ILP)转向数据级并行(DLP)和线程级并行(TLP)。



## 2. 计算机分类

个人移动设备、桌面计算机、服务器、集群、嵌入式计算机



## 3. 并行体系结构的分类

在应用程序中主要有两种并行:

- 数据级并行(Data-level parallelism)
- 任务级并行(Task-level parallelism)

计算机硬件主要采取如下4种方法来实现这两种并行：

- 指令级并行，利用流水线之类的思想和预测执行来进行数据级并行
- 向量体系架构和GPU，将单条指令并行应用于一个数据集合，实现数据级并行。SIMD、MIMD
- 线程级并行，用紧耦合硬件模型的方式实现数据级并行或任务级并行，而且允许多个并行的线程之间交互。
- 请求级并行，使用大量的解耦合任务来实现并行。



## 4. 指令集体系结构(ISA)

- 分类：现在几乎所有的 ISA 都划分到通用寄存器的体系结构中，操作数是寄存器或存储器地址。x64 有 16 个通用寄存器以及 16 个浮点寄存器(128 位 XMM 寄存器)。这一类主要有两种版本，一种是 **register-memory ISA**，比如 x86，访问内存地址可以是指令的一部分；另一种是 **load-store ISA**。比如 ARMv8、RISC-V，MIPS等，访问内存只能通过 `load` 或 `store` 指令。
- 存储器寻址：几乎所有的计算机都使用字节寻址来访问存储器操作数。有些体系结构，比如ARMv8、MIPS 要求对象必须是对齐的(*aligned*)，即一个大小为 s 字节的对象，其字节地址为 A，如果 `A % s == 0`，则这个对象是对齐的。x86 不需要对齐。
- 寻址模式：RISC-V 的寻址模式有寄存器寻址、立即数寻址、偏移量寻址(Displacement，`M[R1 + Imm]`)；x86 支持以上三种之外，还支持其他偏移量寻址的变体：绝对寻址、变址寻址、比例变址寻址。（具体见x64汇编）。ARMv8 也有 RISC-V 的三种寻址模式，再加上相对 PC 寻址（相对寻址）、寄存器移位寻址、堆栈寻址、多寄存器寻址。
- 操作数的类型和大小：大多数的 ISA 都支持 8-bit ASCII 字符，16-bit Unicode 字符或半字，32-bit 整型或字，64-bit 长整型和双字，IEEE754 标准的 32-bit 单精度浮点数和 64-bit 双精度浮点数。x86 支持 80-bit 的浮点数。
- 操作指令：常见的操作指令有数据传输指令、算术逻辑指令、控制指令、浮点指令。x86 的指令更多一些。
- 控制流指令：通常支持条件分支、无条件跳转、过程间调用和返回
- ISA 编码：有两种编码方式，固定长度(*fixed length*)和可变长度(*variable length*)。所以的 ARMv8 和 RISC-V 是 32 位长的，简化了编码。x86 是变长编码，范围从 1 字节到 18 字节。变长指令比定长指令要节省空间，所以编译同一个程序在 x86 平台上通常会更小一些。(Note: ARMv8 和 RISC-V 之后提供了扩展，Thumb-2 和 RV64IC，支持 16 位指令，来减少程序的大小)





